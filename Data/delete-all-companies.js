const fs=require('fs').promises;

const { initializeApp, cert } = require('firebase-admin/app');
const { getFirestore } = require('firebase-admin/firestore');

const serviceAccount=require('../Private/joelgrayson-techmap.json');

initializeApp({
    credential: cert(serviceAccount)
});

const db=getFirestore(); //use the (default) firebase database because this is what @FirestoreQuery works with

// Generated by ChatGPT
async function deleteAllCompanies() {
    try {
        console.log('Starting to delete all companies...');
        
        const companiesRef = db.collection('companies');
        const snapshot = await companiesRef.get();
        
        if (snapshot.empty) {
            console.log('No companies found to delete.');
            return;
        }
        
        console.log(`Found ${snapshot.size} companies to delete.`);
        
        // Delete in batches to avoid hitting Firestore limits
        const batch = db.batch();
        let count = 0;
        
        snapshot.forEach((doc) => {
            batch.delete(doc.ref);
            count++;
        });
        
        await batch.commit();
        console.log(`Successfully deleted ${count} companies.`);
    } catch (error) {
        console.error('Error deleting companies:', error);
    }
}

deleteAllCompanies();

